<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/pages/ift/ift-documentation/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/pages/ift/ift-documentation/stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/pages/ift/ift-documentation/stylesheets/print.css" media="print">
    <title>Installation Frameworks Team</title>
    
    <script language="javascript">    	
        window.addEventListener('load', function () {
    		var lst = document.getElementsByTagName("details");	
			var found = false;		
    		for (var i = 0; i < lst.length; i++) {        			
			  	var nodes = lst[i].getElementsByTagName('li');		
				for (var j = 0; j < nodes.length; j++) { 
					if(nodes[j].className == "active") {						
						lst[i].open=true;						
					}
				}					    		     		  
    		}
    	})
    
    	function showDocumentEmbeded(url, element) {    
        	document.getElementById('mainContent').style.display="none";
        	
        	document.getElementById('embededDocumentContainer').style.background = "url('/pages/ift/ift-documentation/images/loading.gif') top center no-repeat";
        	document.getElementById('embededDocumentContainer').style.display="block";
    		
        	document.getElementById('framedDocument').src = url;
        	
        	var lst = document.getElementsByTagName("LI");
    		for (var i = 0; i < lst.length; i++) {
    		  if(lst[i].className.trim().indexOf("active") == 0 ) {
    			  lst[i].className = "";
    		  }
    		}
    		document.getElementById(element).className = "active";
    		window.history.pushState('edgelm', 'Installation Frameworks Team', url);    		
    	}
    	
    	function embededDocumentLoaded() {
    		document.getElementById('embededDocumentContainer').style.background = ""; 
    		document.getElementById('embededDocumentContainer').style.display="block";
    	}
    </script>
    
  </head>
  <body>
    <header>
      <div class="inner">
        <h1>Installation&nbsp;Frameworks&nbsp;Team</h1>
        <h2>&nbsp;&nbsp;All you need in one place</h2>
      </div>
    </header>
    
    <div id="content-wrapper">
      <div class="clearfix">
        <table border="0"><tr style="padding:0px 0px 0px 0px;">
        	
        		
		        	<td style="padding:0px 20px 10px 10px;border-bottom: 4px solid #69c;" width="1%" align="left">
		        	<h4 class="menu_topic"><a style="cursor: default; font-weight: bold; href="/pages/ift/ift-documentation/pages/ift/index" target="_self" title="High protein veg ideas">Vegeterian high-protein</a></h4>
		        
		        </td>
        	
        	<td style="padding:0px 0px 0px 0px; border-bottom: 4px solid #69c;" width="99%" />
        </tr>
        </table>
      	<table border="0"><tr>
      		
      			
      				<td width="300px" valign="top" aligh="left" style="border-right:4px solid #69c">
		      			<h4 class="menu_topic">High protein veg ideas</h4>
		      			<ul style="margin: 3px 5px 3px 10px;">
		      				
      				
			
	    <li style="font-size:16px; padding: 2px 0px 0px 0px;" id="__lnk__0_1" class="">
	      
	      	<a href="/pages/ift/ift-documentation/pages/ift/team" target="_self" title="">Feta Cheese and grilled veggies</a>
	      							      
	    </li>
		
      				
			
	    <li style="font-size:16px; padding: 2px 0px 0px 0px;" id="__lnk__0_2" class="">
	      
	      	<a href="/pages/ift/ift-documentation/pages/ift/team" target="" title="Moong dal chilla">Mong Dal Chilla</a>
	      							      
	    </li>
		
      				
	
	    
			</ul>
			<details style="padding: 0px 5px 0px 16px;"><summary style="cursor: pointer; padding:2px 0px 2px 0px; font-size:12px; font-weight: bold;">Security Scans</summary>
			<ul style="margin: 3px 5px 3px 10px;">
	    		    	   
			   
      				
			
	    <li style="font-size:16px; padding: 2px 0px 0px 0px;" id="__lnk__0__1" class="">
	      
	      	<a href="/pages/ift/ift-documentation/pages/ift/whitesource" target="_self" title="Whitesource">Whitesource</a>
	      							      
	    </li>
		
      				
			
	    <li style="font-size:16px; padding: 2px 0px 0px 0px;" id="__lnk__0__2" class="">
	      
	      	<a href="/pages/ift/ift-documentation/pages/ift/protecode" target="_self" title="Protecode">Protecode</a>
	      							      
	    </li>
		
      				
			
	    <li style="font-size:16px; padding: 2px 0px 0px 0px;" id="__lnk__0__3" class="">
	      
	      	<a href="/pages/ift/ift-documentation/pages/ift/checkmarx" target="_self" title="Protecode">Checkmarx</a>
	      							      
	    </li>
		
      				
			
	    <li style="font-size:16px; padding: 2px 0px 0px 0px;" id="__lnk__0__4" class="">
	      
	      	<a href="/pages/ift/ift-documentation/pages/ift/protecode" target="_self" title="Protecode">Iungo reports</a>
	      							      
	    </li>
		


			
			</ul></details>
			<ul style="margin: 3px 5px 3px 10px;">			
		
		
      				
	
	    
			</ul>
			<details style="padding: 0px 5px 0px 16px;"><summary style="cursor: pointer; padding:2px 0px 2px 0px; font-size:12px; font-weight: bold;">Hyperscaler</summary>
			<ul style="margin: 3px 5px 3px 10px;">
	    		    	   
			   
      				
			
	    <li style="font-size:16px; padding: 2px 0px 0px 0px;" id="__lnk__0___1" class="">
	      
	      	<a href="/pages/ift/ift-documentation/pages/ift/hyperscaler/alibaba" target="_self" title="">Alibaba</a>
	      							      
	    </li>
		


			
			</ul></details>
			<ul style="margin: 3px 5px 3px 10px;">			
		
		


						</ul>
					</td>
					<!-- style="border-right:4px solid blue"<td width="10px" valign="top"><aside id="sidebar"></aside></td> -->
				
			
	        <td valign="top">
		        <section id="main-content">
		        	<div id="mainContent"><h2 id="table-of-contents">Table of contents</h2>

<hr />

<ul>
  <li><a href="#create-aws-cluster-and-run-elm-installation">Create a AWS cluster and run an elm installation on it</a></li>
</ul>

<!--te-->
<hr />

<h3 id="create-a-aws-cluster-and-run-an-elm-installation-on-it">Create a AWS cluster and run an elm installation on it</h3>

<h4 id="create-a-cluster">Create a cluster</h4>

<p>Cluster creation on AWS is very complicated. For now, please ask Billig, Klaus to create a cluster for you.
He will provide the following information:</p>
<ul>
  <li>Cluster name</li>
  <li>Jump host IP and username</li>
  <li>PPK file to access the jump host</li>
</ul>

<h4 id="logon-to-the-cluster">Logon to the cluster</h4>

<p>If you are using Windows and Putty it should be very easy to use the “.PPK” (Private Key) file to logon to the jump host with Putty.
If you are using a command line to logon via SSH, then you need to convert the file into a “.pem” format:</p>
<ul>
  <li>Install putty-gen tools</li>
  <li>Run “puttygen &lt;.ppk file from Klaus&gt; -O private-openssh -o &lt;output filename&gt;”</li>
  <li>Now logon with “ssh -i &lt;.pem file&gt; &lt;jump host ip&gt; -l &lt;user&gt;”</li>
</ul>

<h4 id="switch-to-admin-user">Switch to admin user</h4>

<p>Only the admin user has access to the cluster and the kubernetes CLI (kubectl)</p>
<ul>
  <li>Run sudo su -</li>
</ul>

<p>To test the connection just run “kubectl get pods -A”</p>

<h4 id="register-kubeconfig-on-elmo">Register kubeconfig on ELMO</h4>
<p>The path to the kubeconfig is /root/.kube/config and is only accessible with the root user.</p>
<ul>
  <li>Open a new terminal</li>
  <li>Run scp &lt;user&gt;@&lt;jump host-ip&gt;:/root/.kube/config &lt;path to local file&gt;</li>
</ul>

<p>Now you can register the cluster via the elmo UI or you use our internal tool <a href="https://github.wdf.sap.corp/edgelm/elm-bridge-oq-util">elm-util</a>:</p>
<ul>
  <li>Follow the instructions of the Readme.md to install the tool on your local machine.</li>
</ul>

<p>You need an env json file to access the ELMO system.</p>
<ul>
  <li>Ask a colleague to provide you the elmo-env.json for the “test” system.</li>
  <li>Place the file into following path: &lt;userfolder&gt;/.ssh/elmo-env.json</li>
</ul>

<p>Now you can register the Cluster:</p>
<ul>
  <li>KUBECONFIG=&lt;configfilepath&gt; elm-util -a registerCluster -p &lt;password for context&gt;</li>
  <li>Now you need to decrypt the downloaded context: elm-util -a decryptContext -p &lt;same password&gt; -c context.cfg</li>
</ul>

<h4 id="prepare-elm-init-run">Prepare elm init run</h4>

<p>Before you can run elm init, you need to edit the elmo-input.yaml file which is in the downloaded and decrypted context:</p>
<ul>
  <li>Unzip the elmo-input.yaml file from the context archive.</li>
  <li>Open the file and comment out “KUBECONFIG=config”</li>
  <li>Put the edited file back into the context archive</li>
</ul>

<p>Next you need an inifile.yml to specify the target registry.
Create a new infile.yml and add these two lines:</p>
<ul>
  <li>ELM_TARGET_REGISTRY: “&lt;123456789012&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com/&lt;project&gt;”</li>
  <li>ELM_TARGET_REGISTRY_TYPE: “Generic”</li>
</ul>

<p>Now you have to upload the context archive and the inifile.yml to the jump host:</p>
<ul>
  <li>Run “scp &lt;path to context archive&gt; &lt;user&gt;@&lt;jump host-ip&gt;:/home/&lt;user&gt;/context.zip”</li>
  <li>Run “scp &lt;path to inifile&gt; &lt;user&gt;@&lt;jump host-ip&gt;:/home/&lt;user&gt;/inifile.yml”</li>
</ul>

<h4 id="run-elm-init">Run elm init</h4>

<ul>
  <li>Go back to the terminal window, where you have the ssh connection to the jump host</li>
  <li>Move to folder “/home/&lt;user&gt;/”</li>
  <li>Run elm init with the context and the inifile.yml, which you uploaded before</li>
</ul>

<h4 id="cleanup">Cleanup</h4>

<p>Unregister cluster in elmo:</p>
<ul>
  <li>Run elm-util -a getClusters</li>
  <li>Search for your cluster and remember the id</li>
  <li>Run elm-util -a deleteCluster –id &lt;id&gt;</li>
</ul>

<p>Last step:</p>
<ul>
  <li>Ask Billig, Klaus to delete the Cluster again</li>
</ul>
</div> 
					<div id="embededDocumentContainer" style="background:url('/pages/ift/ift-documentation/images/loading.gif') top center no-repeat; display:none;">
					  <iframe id="framedDocument" onload="javascript:embededDocumentLoaded();" style="border:none;" height="1150px" width="100%" src=""></iframe>
					</div>
		        </section>
	        </td>
	  	</tr></table>
      </div>
    </div>
  </body>
</html>
